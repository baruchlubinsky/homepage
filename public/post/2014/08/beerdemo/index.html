<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title> Getting started with Ember and Ember Data using Ember CLI &middot; Baruch Lubinsky </title>

   <meta name="description" content="Develop an application demonstarting how easy it is to build data driven applications using Ember.js."> 

  
  <link rel="stylesheet" href="http://localhost:1313/css/poole.css">
  <link rel="stylesheet" href="http://localhost:1313/css/syntax.css">
  <link rel="stylesheet" href="http://localhost:1313/css/hyde.css">
  <link rel="stylesheet" href="http://localhost:1313/css/me.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.ico">

  
  <link href="" rel="alternate" type="application/rss+xml" title="Baruch Lubinsky" />
</head>

<body class="layout-reverse">
<nav class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
       
        <p class="lead">
          Getting started with Ember and Ember Data using Ember CLI
        </p>
        
          <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#toc_0">Getting started</a></li>
<li><a href="#toc_1">Models</a>
<ul>
<li>
<ul>
<li><a href="#toc_2"><code>app/models/beer.js</code></a></li>
<li><a href="#toc_3"><code>app/models/comment.js</code></a></li>
</ul></li>
</ul></li>
<li><a href="#toc_4">Router</a>
<ul>
<li>
<ul>
<li><a href="#toc_5"><code>app/router.js</code></a></li>
</ul></li>
</ul></li>
<li><a href="#toc_6">Routes</a>
<ul>
<li>
<ul>
<li><a href="#toc_7"><code>app/routes/beers/index.js</code></a></li>
<li><a href="#toc_8"><code>app/routes/beers/new.js</code></a></li>
<li><a href="#toc_9"><code>app/routes/beers/edit.js</code></a></li>
<li><a href="#toc_10"><code>app/routes/beers/show.js</code></a></li>
</ul></li>
</ul></li>
<li><a href="#toc_11">Controllers and Views</a></li>
<li><a href="#toc_12">Adapter</a>
<ul>
<li>
<ul>
<li><a href="#toc_13"><code>app/adapters/application.js</code></a></li>
</ul></li>
</ul></li>
<li><a href="#toc_14">Serializer</a>
<ul>
<li>
<ul>
<li><a href="#toc_15"><code>app/serializers/application.js</code></a></li>
</ul></li>
</ul></li>
<li><a href="#toc_16">Templates</a>
<ul>
<li>
<ul>
<li><a href="#toc_17"><code>app/templates/beers/show.hbs</code></a></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</nav>
        
      
    </div>

    <ul class="sidebar-nav">
      <li><a href="/">Home</a> </li>
      <li><a href="/post">Blog</a> </li>
    </ul>
  </div>
</nav>

    <div class="content container">
		<article class="post">
			<h1>Getting started with Ember and Ember Data using Ember CLI</h1>
  			<time class="post-date">Wed, Aug 13, 2014</time>
      		

<p>This article describes a minimal <a href="http://emberjs.com/">Ember</a> application. Ember, like <a href="http://rubyonrails.org/">Rails</a>, is designed with a philosophy of convention over configuration. This demo is designed to demonstrate how little code is required to create a functional data driven website by harnessing <a href="http://emberjs.com/guides/models/">Ember Data</a> and the <a href="http://emberjs.com/guides/models/the-rest-adapter/">REST Adapter</a>.</p>

<h2 id="toc_0">Getting started</h2>

<p>I use <a href="http://www.ember-cli.com/">Ember CLI</a> to build my site. Ember CLI uses ES6 Modules to organise code. This leads to well structured, logically layed out code (unlike traditional Javascript). For a backend I wrote a <a href="http://appengine.google.com/">Google App Engine</a> program, it does not contain any business logic. All the data processing is handled by the Ember App.</p>

<p>The application keeps track of a list of beers, and comments about each beer. All the CRUD functions are implemented, and the data contains a &ldquo;has-many&rdquo; relationship. The rest of this article explains the files I added to the scaffolding from Ember CLI. <a href="https://github.com/baruchlubinsky/beerdemo/tree/e6a7984c9692a62198ee06ba1961a819ed990c97">Clone the repo.</a></p>

<h2 id="toc_1">Models</h2>

<p>The data model is very simple, two model and one relationship. See the <a href="http://emberjs.com/guides/models/the-rest-adapter/#toc_relationships">docs</a> explaining how <code>async</code> affects the JSON.</p>

<h4 id="toc_2"><code>app/models/beer.js</code></h4>

<div class="highlight" style="background: #f0f0f0"><pre style="line-height: 125%"><span style="color: #007020; font-weight: bold">import</span> DS from <span style="color: #4070a0">&#39;ember-data&#39;</span>;

<span style="color: #007020; font-weight: bold">export</span> <span style="color: #007020; font-weight: bold">default</span> DS.Model.extend({
  name<span style="color: #666666">:</span> DS.attr(<span style="color: #4070a0">&#39;string&#39;</span>),
  type<span style="color: #666666">:</span> DS.attr(<span style="color: #4070a0">&#39;string&#39;</span>),
  comments<span style="color: #666666">:</span> DS.hasMany(<span style="color: #4070a0">&#39;comment&#39;</span>, {async<span style="color: #666666">:</span> <span style="color: #007020; font-weight: bold">true</span>}),
});
</pre></div>

<h4 id="toc_3"><code>app/models/comment.js</code></h4>

<div class="highlight" style="background: #f0f0f0"><pre style="line-height: 125%"><span style="color: #007020; font-weight: bold">import</span> DS from <span style="color: #4070a0">&#39;ember-data&#39;</span>;

<span style="color: #007020; font-weight: bold">export</span> <span style="color: #007020; font-weight: bold">default</span> DS.Model.extend({
  user<span style="color: #666666">:</span> DS.attr(<span style="color: #4070a0">&#39;string&#39;</span>),
  message<span style="color: #666666">:</span> DS.attr(<span style="color: #4070a0">&#39;string&#39;</span>),
  beer<span style="color: #666666">:</span> DS.belongsTo(<span style="color: #4070a0">&#39;beer&#39;</span>),
});
</pre></div>

<h2 id="toc_4">Router</h2>

<p>Comments are added at <code>beers.show</code> and records are deleted from <code>beers.edit</code>.</p>

<h4 id="toc_5"><code>app/router.js</code></h4>

<div class="highlight" style="background: #f0f0f0"><pre style="line-height: 125%"><span style="color: #007020; font-weight: bold">import</span> Ember from <span style="color: #4070a0">&#39;ember&#39;</span>;

<span style="color: #007020; font-weight: bold">var</span> Router <span style="color: #666666">=</span> Ember.Router.extend({
  location<span style="color: #666666">:</span> DemoENV.locationType
});

Router.map(<span style="color: #007020; font-weight: bold">function</span>() {
    <span style="color: #007020; font-weight: bold">this</span>.resource(<span style="color: #4070a0">&#39;beers&#39;</span>, <span style="color: #007020; font-weight: bold">function</span>() {
        <span style="color: #007020; font-weight: bold">this</span>.route(<span style="color: #4070a0">&#39;new&#39;</span>);
        <span style="color: #007020; font-weight: bold">this</span>.route(<span style="color: #4070a0">&#39;show&#39;</span>, {path<span style="color: #666666">:</span> <span style="color: #4070a0">&#39;:id&#39;</span>});
        <span style="color: #007020; font-weight: bold">this</span>.route(<span style="color: #4070a0">&#39;edit&#39;</span>, {path<span style="color: #666666">:</span> <span style="color: #4070a0">&#39;:id/edit&#39;</span>});
    });
});

<span style="color: #007020; font-weight: bold">export</span> <span style="color: #007020; font-weight: bold">default</span> Router;
</pre></div>

<h2 id="toc_6">Routes</h2>

<p><code>/beers</code> shows a list of all the beer records.</p>

<h4 id="toc_7"><code>app/routes/beers/index.js</code></h4>

<div class="highlight" style="background: #f0f0f0"><pre style="line-height: 125%"><span style="color: #007020; font-weight: bold">import</span> Ember from <span style="color: #4070a0">&#39;ember&#39;</span>;

<span style="color: #007020; font-weight: bold">export</span> <span style="color: #007020; font-weight: bold">default</span> Ember.Route.extend({
    model<span style="color: #666666">:</span> <span style="color: #007020; font-weight: bold">function</span>() {<span style="color: #007020; font-weight: bold">return</span> <span style="color: #007020; font-weight: bold">this</span>.store.find(<span style="color: #4070a0">&#39;beer&#39;</span>);},
});
</pre></div>

<p><code>/beers/new</code> provides allows a new record to be created.</p>

<h4 id="toc_8"><code>app/routes/beers/new.js</code></h4>

<div class="highlight" style="background: #f0f0f0"><pre style="line-height: 125%"><span style="color: #007020; font-weight: bold">import</span> Ember from <span style="color: #4070a0">&#39;ember&#39;</span>;

<span style="color: #007020; font-weight: bold">export</span> <span style="color: #007020; font-weight: bold">default</span> Ember.Route.extend({
    model<span style="color: #666666">:</span> <span style="color: #007020; font-weight: bold">function</span>() {<span style="color: #007020; font-weight: bold">return</span> <span style="color: #007020; font-weight: bold">this</span>.store.createRecord(<span style="color: #4070a0">&#39;beer&#39;</span>);},
    actions<span style="color: #666666">:</span> {
        create<span style="color: #666666">:</span> <span style="color: #007020; font-weight: bold">function</span>() {
            <span style="color: #007020; font-weight: bold">var</span> self <span style="color: #666666">=</span> <span style="color: #007020; font-weight: bold">this</span>;
            <span style="color: #007020; font-weight: bold">this</span>.controller.get(<span style="color: #4070a0">&#39;model&#39;</span>).save().then(
                <span style="color: #007020; font-weight: bold">function</span>() {
                    self.transitionTo(<span style="color: #4070a0">&#39;beers.index&#39;</span>);
                });
        }
    }
});
</pre></div>

<p><code>/beers/:id/edit</code> updates a record. The <code>:id</code> from the URL is available to the model hook as <code>params.id</code>.</p>

<h4 id="toc_9"><code>app/routes/beers/edit.js</code></h4>

<div class="highlight" style="background: #f0f0f0"><pre style="line-height: 125%"><span style="color: #007020; font-weight: bold">import</span> Ember from <span style="color: #4070a0">&#39;ember&#39;</span>;

<span style="color: #007020; font-weight: bold">export</span> <span style="color: #007020; font-weight: bold">default</span> Ember.Route.extend({
    model<span style="color: #666666">:</span> <span style="color: #007020; font-weight: bold">function</span>(params) {<span style="color: #007020; font-weight: bold">return</span> <span style="color: #007020; font-weight: bold">this</span>.store.find(<span style="color: #4070a0">&#39;beer&#39;</span>, params.id);},
    actions<span style="color: #666666">:</span> {
        save<span style="color: #666666">:</span> <span style="color: #007020; font-weight: bold">function</span>() {
            <span style="color: #007020; font-weight: bold">var</span> self <span style="color: #666666">=</span> <span style="color: #007020; font-weight: bold">this</span>;
            self.controller.get(<span style="color: #4070a0">&#39;model&#39;</span>).save().then(
                <span style="color: #007020; font-weight: bold">function</span>() {
                    self.transitionTo(<span style="color: #4070a0">&#39;beers.index&#39;</span>);
                });
        },
        <span style="color: #007020; font-weight: bold">delete</span><span style="color: #666666">:</span> <span style="color: #007020; font-weight: bold">function</span>() {
            <span style="color: #007020; font-weight: bold">var</span> self <span style="color: #666666">=</span> <span style="color: #007020; font-weight: bold">this</span>;
            <span style="color: #007020; font-weight: bold">var</span> model <span style="color: #666666">=</span> self.controller.get(<span style="color: #4070a0">&#39;model&#39;</span>); 
            model.destroyRecord().then(
                <span style="color: #007020; font-weight: bold">function</span>() {
                    self.transitionTo(<span style="color: #4070a0">&#39;beers.index&#39;</span>);
                }, <span style="color: #007020; font-weight: bold">function</span> (error) {
                    Ember.Logger.debug(error);
                });
        }
    }
});
</pre></div>

<p><code>/beers/:id</code> displays an individual beer record and adds comments to it.</p>

<h4 id="toc_10"><code>app/routes/beers/show.js</code></h4>

<div class="highlight" style="background: #f0f0f0"><pre style="line-height: 125%"><span style="color: #007020; font-weight: bold">import</span> Ember from <span style="color: #4070a0">&#39;ember&#39;</span>;

<span style="color: #007020; font-weight: bold">export</span> <span style="color: #007020; font-weight: bold">default</span> Ember.Route.extend({
    model<span style="color: #666666">:</span> <span style="color: #007020; font-weight: bold">function</span>(params) {
        <span style="color: #007020; font-weight: bold">return</span> <span style="color: #007020; font-weight: bold">this</span>.store.find(<span style="color: #4070a0">&#39;beer&#39;</span>, params.id);
    },
    setupController<span style="color: #666666">:</span> <span style="color: #007020; font-weight: bold">function</span>(controller, model) {
        controller.set(<span style="color: #4070a0">&#39;model&#39;</span>, model);
        controller.set(<span style="color: #4070a0">&#39;newComment&#39;</span>, <span style="color: #007020; font-weight: bold">this</span>.store.createRecord(<span style="color: #4070a0">&#39;comment&#39;</span>));
    },
    actions<span style="color: #666666">:</span> {
        comment<span style="color: #666666">:</span> <span style="color: #007020; font-weight: bold">function</span>() {
            <span style="color: #007020; font-weight: bold">var</span> self <span style="color: #666666">=</span> <span style="color: #007020; font-weight: bold">this</span>;
            <span style="color: #007020; font-weight: bold">var</span> comment <span style="color: #666666">=</span> self.controller.get(<span style="color: #4070a0">&#39;newComment&#39;</span>);
            <span style="color: #007020; font-weight: bold">var</span> beer <span style="color: #666666">=</span> self.controller.get(<span style="color: #4070a0">&#39;model&#39;</span>);
            beer.get(<span style="color: #4070a0">&#39;comments&#39;</span>).addObject(comment);
            comment.save().then( <span style="color: #60a0b0; font-style: italic">// comment first to get an ID</span>
                <span style="color: #007020; font-weight: bold">function</span>() {
                    beer.save().then(
                        <span style="color: #007020; font-weight: bold">function</span>() {
                            self.controller.set(<span style="color: #4070a0">&#39;newComment&#39;</span>, self.store.createRecord(<span style="color: #4070a0">&#39;comment&#39;</span>));
                        }
                    );
                }
            );
        },
        willTransition<span style="color: #666666">:</span> <span style="color: #007020; font-weight: bold">function</span>() {
            <span style="color: #007020; font-weight: bold">this</span>.controller.get(<span style="color: #4070a0">&#39;newComment&#39;</span>).destroyRecord();
            <span style="color: #007020; font-weight: bold">return</span> <span style="color: #007020; font-weight: bold">true</span>;
        }
    }
});
</pre></div>

<p>The <code>willTransition</code> handler is necessary to clean up when the route is changed by the back button.</p>

<h2 id="toc_11">Controllers and Views</h2>

<p>This application works with the default controllers and views.</p>

<h2 id="toc_12">Adapter</h2>

<p>Connect Ember Data to the webservice. You&rsquo;re welcome to try out my instance, but if you want to use it more heavily please <a href="https://github.com/baruchlubinsky/everyrest">create your own on the App Engine</a>.</p>

<h4 id="toc_13"><code>app/adapters/application.js</code></h4>

<div class="highlight" style="background: #f0f0f0"><pre style="line-height: 125%"><span style="color: #007020; font-weight: bold">import</span> DS from <span style="color: #4070a0">&#39;ember-data&#39;</span>;

<span style="color: #007020; font-weight: bold">export</span> <span style="color: #007020; font-weight: bold">default</span> DS.RESTAdapter.extend({
    host<span style="color: #666666">:</span> <span style="color: #4070a0">&quot;http://everyrest.appspot.com&quot;</span>,
    ajax<span style="color: #666666">:</span> <span style="color: #007020; font-weight: bold">function</span>(url, method, hash) {
        hash <span style="color: #666666">=</span> hash <span style="color: #666666">||</span> {}; <span style="color: #60a0b0; font-style: italic">// hash may be undefined</span>
        hash.crossDomain <span style="color: #666666">=</span> <span style="color: #007020; font-weight: bold">true</span>;
        hash.xhrFields <span style="color: #666666">=</span> {withCredentials<span style="color: #666666">:</span> <span style="color: #007020; font-weight: bold">false</span>};
        <span style="color: #007020; font-weight: bold">return</span> <span style="color: #007020; font-weight: bold">this</span>._super(url, method, hash);        
    }
});
</pre></div>

<h2 id="toc_14">Serializer</h2>

<p>See the <a href="// http://emberjs.com/api/data/classes/DS.RESTSerializer.html#method_serializeHasMany">docs</a> to see how this causes a model to write an array of its &ldquo;has-many&rdquo; ID&rsquo;s to the server. This is not the defualt since most servers take responsibility for tracking relationships in the data.</p>

<h4 id="toc_15"><code>app/serializers/application.js</code></h4>

<div class="highlight" style="background: #f0f0f0"><pre style="line-height: 125%"><span style="color: #007020; font-weight: bold">import</span> DS from <span style="color: #4070a0">&#39;ember-data&#39;</span>;

<span style="color: #007020; font-weight: bold">export</span> <span style="color: #007020; font-weight: bold">default</span> DS.RESTSerializer.extend({
    serialize<span style="color: #666666">:</span> <span style="color: #007020; font-weight: bold">function</span>(record, options) {
        <span style="color: #007020; font-weight: bold">var</span> json <span style="color: #666666">=</span> <span style="color: #007020; font-weight: bold">this</span>._super(record, options);
        record.eachRelationship(<span style="color: #007020; font-weight: bold">function</span>(name, relationship) {
          <span style="color: #007020; font-weight: bold">if</span> (relationship.kind <span style="color: #666666">===</span> <span style="color: #4070a0">&#39;hasMany&#39;</span>) {
            json[name] <span style="color: #666666">=</span> record.get(name).mapBy(<span style="color: #4070a0">&#39;id&#39;</span>);
          }
        });
        <span style="color: #007020; font-weight: bold">return</span> json;
      }
});) 
</pre></div>

<h2 id="toc_16">Templates</h2>

<p>There is nothing special about the <a href="http://emberjs.com/guides/templates/handlebars-basics/">templates</a> I have used in this app. Here is the template for <code>show</code> as an example.</p>

<h4 id="toc_17"><code>app/templates/beers/show.hbs</code></h4>

<div class="highlight" style="background: #f0f0f0"><pre style="line-height: 125%"><span style="color: #062873; font-weight: bold">&lt;h2&gt;</span><span style="color: #007020">{{</span><span style="color: #bb60d5">name</span><span style="color: #007020">}}</span><span style="color: #062873; font-weight: bold">&lt;/h2&gt;</span>
<span style="color: #062873; font-weight: bold">&lt;h3&gt;</span><span style="color: #007020">{{</span><span style="color: #bb60d5">type</span><span style="color: #007020">}}</span><span style="color: #062873; font-weight: bold">&lt;/h3&gt;</span>
<span style="color: #062873; font-weight: bold">&lt;h4&gt;</span>Comments<span style="color: #062873; font-weight: bold">&lt;/h4&gt;</span>
<span style="color: #062873; font-weight: bold">&lt;ul&gt;</span>
<span style="color: #007020">{{</span><span style="border: 1px solid #FF0000">#</span><span style="color: #bb60d5">each</span> <span style="color: #bb60d5">model.comments</span><span style="color: #007020">}}</span>
<span style="color: #062873; font-weight: bold">&lt;li&gt;</span>
    <span style="color: #062873; font-weight: bold">&lt;p&gt;</span><span style="color: #007020">{{</span><span style="color: #bb60d5">message</span><span style="color: #007020">}}</span><span style="color: #062873; font-weight: bold">&lt;/p&gt;</span>
    <span style="color: #062873; font-weight: bold">&lt;em&gt;</span><span style="color: #007020">{{</span><span style="color: #bb60d5">user</span><span style="color: #007020">}}</span><span style="color: #062873; font-weight: bold">&lt;/em&gt;</span>
<span style="color: #062873; font-weight: bold">&lt;/li&gt;</span>
<span style="color: #007020">{{</span><span style="color: #666666">/</span><span style="color: #bb60d5">each</span><span style="color: #007020">}}</span>
<span style="color: #062873; font-weight: bold">&lt;/ul&gt;</span>
<span style="color: #062873; font-weight: bold">&lt;h4&gt;</span>Post<span style="color: #062873; font-weight: bold">&lt;/h4&gt;</span>
<span style="color: #062873; font-weight: bold">&lt;p&gt;</span>Name:<span style="color: #062873; font-weight: bold">&lt;/br&gt;</span>
<span style="color: #007020">{{</span><span style="color: #bb60d5">input</span> <span style="color: #bb60d5">value</span><span style="color: #666666">=</span><span style="color: #bb60d5">newComment.user</span><span style="color: #007020">}}</span><span style="color: #062873; font-weight: bold">&lt;/p&gt;</span>
<span style="color: #062873; font-weight: bold">&lt;p&gt;</span>Comment:<span style="color: #062873; font-weight: bold">&lt;/br&gt;</span>
<span style="color: #007020">{{</span><span style="color: #bb60d5">textarea</span> <span style="color: #bb60d5">value</span><span style="color: #666666">=</span><span style="color: #bb60d5">newComment.message</span> <span style="color: #bb60d5">cols</span><span style="color: #666666">=</span><span style="color: #4070a0">&quot;40&quot;</span> <span style="color: #bb60d5">rows</span><span style="color: #666666">=</span><span style="color: #4070a0">&quot;4&quot;</span><span style="color: #007020">}}</span><span style="color: #062873; font-weight: bold">&lt;/p&gt;</span>
<span style="color: #062873; font-weight: bold">&lt;button</span> <span style="color: #007020">{{</span><span style="color: #bb60d5">action</span> <span style="color: #4070a0">&#39;comment&#39;</span><span style="color: #007020">}}</span><span style="color: #062873; font-weight: bold">&gt;</span>Comment<span style="color: #062873; font-weight: bold">&lt;/button&gt;</span>
</pre></div>

		</article>
		<hr>
		
			<nav class="tags">
			<h5>Filed under</h5>
			
				<a href="/tags/development">development</a>&nbsp;
			
				<a href="/tags/ember">ember</a>&nbsp;
			
				<a href="/tags/tutorial">tutorial</a>&nbsp;
			
				<a href="/tags/emberdata">emberdata</a>&nbsp;
			
		
		<hr>
		<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'blcodingblog';
    var disqus_identifier = 'http:\/\/localhost:1313\/post\/2014\/08\/beerdemo\/';
    var disqus_title = 'Getting started with Ember and Ember Data using Ember CLI';
    var disqus_url = 'http:\/\/localhost:1313\/post\/2014\/08\/beerdemo\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
	  <div class="acknowledge">
        <a href="/post/2014/08/thiswebsite/">Acknowledgments</a>
      </div>
	</div>
  <script>document.write('<script src="http://'
        + (location.host || 'localhost').split(':')[0]
		+ ':1313/livereload.js?mindelay=10"></'
        + 'script>')</script></body>
</html>